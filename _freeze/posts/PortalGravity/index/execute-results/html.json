{
  "hash": "c2b3113cdb47b0a1b1abf717a42aa329",
  "result": {
    "engine": "julia",
    "markdown": "---\ntitle: \"Gravity With Portal\"\nauthor: \"Zhaose\"\ndate: \"2025-12-16\"\ncategories: [physics, computational, classical, fun]\n# image: \"./images/dia2.svg\"\nengine: julia\n---\n\nRecently, I saw [this interesting youtube video](https://www.youtube.com/watch?v=DydIhwLrbMk), at the first glance, I realized it is just solving the classical gravitational equation maybe under a specific boundary condition? It's too fun to not try to do it by myself first, then watch the full video. So I tried to qucikly simulate it using Julia, and analyze the result.\n\nTo simplify the problem, let there be no mass in the space, gravitational field satisfies Laplace equation:\n$$\n\\nabla^2 \\varphi = 0\n$$\nConsider a box, we set gravitational potential of the top to 0, the bottom to 100, and apply periodic boundary on left and right. This setting itself is just like what we do when we calculate the electrical field between two charged infinitely large metal plates, they satisfy the same equation so for classical gravity they do no different.\nOne can use finite elements method or finite difference method to calculate this simple question, to keep it simple I decided to just write a simple finite difference equation constructor in Julia. Then, the portal is actually just remapping the neighbors. Laplace equation is local, for those grid which is next to the portal, we trace their neighbor though the portal, very naive & simple.\n\n::: {#portal .cell execution_count=0}\n``` {.julia .cell-code}\nusing LinearAlgebra\nusing SparseArrays\nusing Plots\n\nconst X_GRIDS     = 1000\nconst Y_GRIDS     = 1000\nconst GRID_WIDTH  = 1\n\nconst PORTAL_1    = CartesianIndices((350:650, 150:150))\nconst PORTAL_2    = CartesianIndices((350:650, 151:151))\nconst PORTAL_3    = CartesianIndices((350:650, 850:850))\nconst PORTAL_4    = CartesianIndices((350:650, 851:851))\n\nconst PAIR_11      = (PORTAL_1, PORTAL_4)\nconst PAIR_12      = (PORTAL_4, PORTAL_1)\nconst PAIR_21      = (PORTAL_2, PORTAL_3)\nconst PAIR_22      = (PORTAL_3, PORTAL_2)\n\nconst PORTAL_PAIRS = [PAIR_11, PAIR_12, PAIR_21, PAIR_22]\n\nfunction build_portal_map()\n    mapping = Dict{CartesianIndex{2}, CartesianIndex{2}}()\n\n    pairs = [\n        (PORTAL_1, PORTAL_4),\n        (PORTAL_4, PORTAL_1),\n        (PORTAL_2, PORTAL_3),\n        (PORTAL_3, PORTAL_2)\n    ]\n    \n    for (src_range, dst_range) in pairs\n        for (src, dst) in zip(src_range, dst_range)\n            mapping[src] = dst\n        end\n    end\n    return mapping\nend\n\nconst PORTAL_MAP = build_portal_map()\nfunction boundary1((i, j))\n  if j < 1 \n    return 0\n  elseif j > Y_GRIDS\n    return 100\n  else\n    return nothing\n  end\nend\n\nfunction periodic_x(x)\n  if x < 1\n    return X_GRIDS\n  elseif x > X_GRIDS\n    return 1\n  else\n    return x\n  end\nend\n\ncis = CartesianIndices((1:X_GRIDS, 1:Y_GRIDS))\nids = LinearIndices(cis)\nn_grids = length(ids)\n\nfunction fill_eq()\n  I = Int[]\n  J = Int[]\n  V = Float64[]\n  ρs = fill(0.0, n_grids)\n  for ci in cis\n    x, y = Tuple(ci)\n    push!(I, ids[x, y])\n    push!(J, ids[x, y])\n    push!(V, 4.0)\n\n    for (i, j) in ((x+1, y), (x-1, y), (x, y+1), (x, y-1))\n      \n      b1 = boundary1((i, j))\n      if !isnothing(b1)\n        ρs[ids[x, y]] += b1\n        continue\n      end\n\n      i = periodic_x(i)\n\n      cid = CartesianIndex(i, j)\n      if haskey(PORTAL_MAP, cid)\n        i, j = Tuple(PORTAL_MAP[cid])\n      end\n      push!(I, ids[x,y])\n      push!(J, ids[i, j])\n      push!(V, -1.0)\n    end\n  end\n  m = sparse(I, J, V, n_grids, n_grids)\n  return m, ρs\nend\n\nfunction get_result()\n  A, b = fill_eq()\n  u = A \\ b\n  u_grid = reshape(u, X_GRIDS, Y_GRIDS)\n  return u_grid\nend\n```\n:::\n\n\nFor this portal configuration, we will get the following result:\n![G Field](./images/fig1.svg)\nThe gravitational field between the portals is quite weak, the field is identical to what one would see if one places 2 connected metal plates between two large charged metal plates! Two metal plates will share the same potential, and for a symmetrical system like this, they will share the potential of zero, and will shield out the field. \nBut portal can face different directions, if we flip one portal's orientation, will the field stay the same? Actually it will. If one go though it carefully, it is not hard to imagine the portal just curves our experimental plane, it pulls up to segments on the plane and stick them together, make it a ring growing out of the flat paper. No matter how you twist the way you stick them together, the sticky boundary will topologically be at the center between the upper and lower boundary, which make the field identical.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}